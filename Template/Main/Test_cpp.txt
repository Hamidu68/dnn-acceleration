#include <iostream>
#include <ap_int.h>
#include "hls_stream.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

using namespace std;

typedef $D_type DATA_T;

$def_model

int main(){

  DATA_T temp; 
  int m, x, y, i, j, k;
  int trash;
  
  $static_variables
  
  FILE *w_stream = fopen("init_Weight.bin", "r");
  if (w_stream == NULL) printf("weight file was not opened");
  FILE *b_stream = fopen("init_Bias.bin", "r");
  if (b_stream == NULL) printf("bias file was not opened");
  FILE *i_stream = fopen("init_Input.bin", "r");
  if (i_stream == NULL) printf("input file was not opened");
  
  $Initialization
 
  $model_function

  int ret_val;
  if (err_cnt == 0) {
    printf("*** TEST PASSED ***\n");
    ret_val = 0;
  } else {
    printf("!!! TEST FAILED - %d mismatches detected !!!\n\n",err_cnt);
    ret_val = -1;
  }

  fclose(w_stream);
  fclose(b_stream);
  fclose(i_stream);
  return ret_val;
}
